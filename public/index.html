<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>GreatRummy</title>
	<link rel="stylesheet" href="rummy.css">
</head>
<body>
	<section class="deck">
		<article class="card"></article>
	</section>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://twitter.github.com/hogan.js/builds/2.0.0/hogan-2.0.0.js"></script>
<script type="text/javascript" src="templates.js"></script>
<script type="text/javascript" src="hoverIntent.js"></script>
<script>
	(function($) {

		var r = {};

		r.cards = [],
		r.cardScores = {
			"A": {
				"score": 11,
				"name": "Ace"
			},
			"K": {
				"score": 10,
				"name": "King"
			},
			"Q": {
				"score": 10,
				"name": "Queen"
			},
			"J": {
				"score": 10,
				"name": "Jack"
			},
			"10": {
				"score": 10,
				"name": "Ten"
			},
			"9": {
				"score": 9,
				"name": "Nine"
			},
			"8": {
				"score": 8,
				"name": "Eight"
			},
			"7": {
				"score": 7,
				"name": "Seven"
			},
			"6": {
				"score": 6,
				"name": "Six"
			},
			"5": {
				"score": 5,
				"name": "Five"
			},
			"4": {
				"score": 4,
				"name": "Four"
			},
			"3": {
				"score": 3,
				"name": "Three"
			},
			"2": {
				"score": 2,
				"name": "Two"
			}
		},
		r.suits = [
			{
				"name": "hearts",
				"symbol": "&hearts;"
			},
			{
				"name": "diamonds",
				"symbol": "&diams;"
			},
			{
				"name": "clubs",
				"symbol": "&clubs;"
			},
			{
				"name": "spades",
				"symbol": "&spades;"
			}
		],
		r.players = {
			"matt.hollis@bt.com": {
				"name": "Matt",
				"cards": []
			},
			"john.t.norris@bt.com": {
				"name": "John",
				"cards": []
			}
		},
		r.opts = {
			"startingCards": 7
		},
		playerTemplate = Hogan.compile(templates.player);

		r.generateCards = function () {
			for (var i = 0; i < r.suits.length; i++) {
				for (var card in r.cardScores) {
					r.cards.push({
						"suit": r.suits[i].name,
						"symbol": r.suits[i].symbol,
						"symbols": function () {
							return function () {
								var symbols = '',
									to = this.score,
									j = 0;
								if (this.score >= 10 && this.name !== 'Ten') {
									to = 1;
								}
								for (j; j < to; j++) {
									symbols += '<li>' + this.symbol + '</li>';
								}
								return symbols;
							}
						},
						"card": card,
						"score": r.cardScores[card].score,
						"name": r.cardScores[card].name
					});
				}
			}
		}

		r.shuffleCards = function() {
			var i = r.cards.length,
				j,
				temp;

		    if ( i == 0 ) return;
		    while ( --i ) {
		        j = Math.floor( Math.random() * ( i + 1 ) );
		        temp = r.cards[i];
		        r.cards[i] = r.cards[j];
		        r.cards[j] = temp;
		    }
		}

		r.dealCards = function () {
			for (var i = 0; i < r.opts.startingCards; i++) {
				for (var player in r.players) {
					r.takeTopCard(r.players[player]);
				}
			}
		}

		r.takeTopCard = function (player) {
			player.cards.push(r.cards.splice(0,1)[0]);
		}

		r.displayDeal = function () {
			for (var player in r.players) {
				$('body').append(playerTemplate.render(r.players[player], partials));
			}
		}

		r.generateCards();
		r.shuffleCards();
		r.dealCards();
		r.displayDeal();

	}(jQuery));

$(".player .card").hoverIntent({
	over: function () {
		$(this).animate({
			'margin-right': -30
		}, 300)
	},
    out: function () {
    	$(this).animate({
			'margin-right': -170
		}, 300)
    },
    interval: 300
});

$(".player .card").on('click', function () {
	$(this).toggleClass('selected');
});


</script>
</html>